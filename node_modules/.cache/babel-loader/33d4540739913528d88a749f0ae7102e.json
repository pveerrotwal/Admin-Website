{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nvar _a;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.BeaconProxyHandler = void 0;\nconst networkMessage_js_1 = __importDefault(require(\"./networkMessage.js\"));\nconst utils_js_1 = require(\"./utils.js\");\n// https://fetch.spec.whatwg.org/#concept-bodyinit-extract\nconst getContentType = data => {\n  if (data instanceof Blob) {\n    return data.type;\n  }\n  if (data instanceof FormData) {\n    return 'multipart/form-data';\n  }\n  if (data instanceof URLSearchParams) {\n    return 'application/x-www-form-urlencoded;charset=UTF-8';\n  }\n  return 'text/plain;charset=UTF-8';\n};\nclass BeaconProxyHandler {\n  constructor(ignoredHeaders, setSessionTokenHeader, sanitize, sendMessage, isServiceUrl) {\n    this.ignoredHeaders = ignoredHeaders;\n    this.setSessionTokenHeader = setSessionTokenHeader;\n    this.sanitize = sanitize;\n    this.sendMessage = sendMessage;\n    this.isServiceUrl = isServiceUrl;\n  }\n  apply(target, thisArg, argsList) {\n    const urlString = argsList[0];\n    const data = argsList[1];\n    const item = new networkMessage_js_1.default(this.ignoredHeaders, this.setSessionTokenHeader, this.sanitize);\n    if (this.isServiceUrl(urlString)) {\n      return target.apply(thisArg, argsList);\n    }\n    const url = (0, utils_js_1.getURL)(urlString);\n    item.method = 'POST';\n    item.url = urlString;\n    item.name = (url.pathname.split('/').pop() || '') + url.search;\n    item.requestType = 'beacon';\n    item.requestHeader = {\n      'Content-Type': getContentType(data)\n    };\n    item.status = 0;\n    item.statusText = 'Pending';\n    if (url.search && url.searchParams) {\n      item.getData = {};\n      for (const [key, value] of url.searchParams) {\n        item.getData[key] = value;\n      }\n    }\n    item.requestData = (0, utils_js_1.genStringBody)(data);\n    if (!item.startTime) {\n      item.startTime = performance.now();\n    }\n    const isSuccess = target.apply(thisArg, argsList);\n    if (isSuccess) {\n      item.endTime = performance.now();\n      item.duration = item.endTime - (item.startTime || item.endTime);\n      item.status = 0;\n      item.statusText = 'Sent';\n      item.readyState = 4;\n    } else {\n      item.status = 500;\n      item.statusText = 'Unknown';\n    }\n    this.sendMessage(item.getMessage());\n    return isSuccess;\n  }\n}\nexports.BeaconProxyHandler = BeaconProxyHandler;\nclass BeaconProxy {\n  static hasSendBeacon() {\n    return !!BeaconProxy.origSendBeacon;\n  }\n  static create(ignoredHeaders, setSessionTokenHeader, sanitize, sendMessage, isServiceUrl) {\n    if (!BeaconProxy.hasSendBeacon()) {\n      return undefined;\n    }\n    return new Proxy(BeaconProxy.origSendBeacon, new BeaconProxyHandler(ignoredHeaders, setSessionTokenHeader, sanitize, sendMessage, isServiceUrl));\n  }\n}\nexports.default = BeaconProxy;\nBeaconProxy.origSendBeacon = (_a = window === null || window === void 0 ? void 0 : window.navigator) === null || _a === void 0 ? void 0 : _a.sendBeacon;","map":{"version":3,"names":["__importDefault","mod","__esModule","_a","Object","defineProperty","exports","value","BeaconProxyHandler","networkMessage_js_1","require","utils_js_1","getContentType","data","Blob","type","FormData","URLSearchParams","constructor","ignoredHeaders","setSessionTokenHeader","sanitize","sendMessage","isServiceUrl","apply","target","thisArg","argsList","urlString","item","default","url","getURL","method","name","pathname","split","pop","search","requestType","requestHeader","status","statusText","searchParams","getData","key","requestData","genStringBody","startTime","performance","now","isSuccess","endTime","duration","readyState","getMessage","BeaconProxy","hasSendBeacon","origSendBeacon","create","undefined","Proxy","window","navigator","sendBeacon"],"sources":["/Users/paramvirrotwal/Observability/website-admin-react-web-app-project/node_modules/@openreplay/tracker/cjs/modules/Network/beaconProxy.js"],"sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nvar _a;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BeaconProxyHandler = void 0;\nconst networkMessage_js_1 = __importDefault(require(\"./networkMessage.js\"));\nconst utils_js_1 = require(\"./utils.js\");\n// https://fetch.spec.whatwg.org/#concept-bodyinit-extract\nconst getContentType = (data) => {\n    if (data instanceof Blob) {\n        return data.type;\n    }\n    if (data instanceof FormData) {\n        return 'multipart/form-data';\n    }\n    if (data instanceof URLSearchParams) {\n        return 'application/x-www-form-urlencoded;charset=UTF-8';\n    }\n    return 'text/plain;charset=UTF-8';\n};\nclass BeaconProxyHandler {\n    constructor(ignoredHeaders, setSessionTokenHeader, sanitize, sendMessage, isServiceUrl) {\n        this.ignoredHeaders = ignoredHeaders;\n        this.setSessionTokenHeader = setSessionTokenHeader;\n        this.sanitize = sanitize;\n        this.sendMessage = sendMessage;\n        this.isServiceUrl = isServiceUrl;\n    }\n    apply(target, thisArg, argsList) {\n        const urlString = argsList[0];\n        const data = argsList[1];\n        const item = new networkMessage_js_1.default(this.ignoredHeaders, this.setSessionTokenHeader, this.sanitize);\n        if (this.isServiceUrl(urlString)) {\n            return target.apply(thisArg, argsList);\n        }\n        const url = (0, utils_js_1.getURL)(urlString);\n        item.method = 'POST';\n        item.url = urlString;\n        item.name = (url.pathname.split('/').pop() || '') + url.search;\n        item.requestType = 'beacon';\n        item.requestHeader = { 'Content-Type': getContentType(data) };\n        item.status = 0;\n        item.statusText = 'Pending';\n        if (url.search && url.searchParams) {\n            item.getData = {};\n            for (const [key, value] of url.searchParams) {\n                item.getData[key] = value;\n            }\n        }\n        item.requestData = (0, utils_js_1.genStringBody)(data);\n        if (!item.startTime) {\n            item.startTime = performance.now();\n        }\n        const isSuccess = target.apply(thisArg, argsList);\n        if (isSuccess) {\n            item.endTime = performance.now();\n            item.duration = item.endTime - (item.startTime || item.endTime);\n            item.status = 0;\n            item.statusText = 'Sent';\n            item.readyState = 4;\n        }\n        else {\n            item.status = 500;\n            item.statusText = 'Unknown';\n        }\n        this.sendMessage(item.getMessage());\n        return isSuccess;\n    }\n}\nexports.BeaconProxyHandler = BeaconProxyHandler;\nclass BeaconProxy {\n    static hasSendBeacon() {\n        return !!BeaconProxy.origSendBeacon;\n    }\n    static create(ignoredHeaders, setSessionTokenHeader, sanitize, sendMessage, isServiceUrl) {\n        if (!BeaconProxy.hasSendBeacon()) {\n            return undefined;\n        }\n        return new Proxy(BeaconProxy.origSendBeacon, new BeaconProxyHandler(ignoredHeaders, setSessionTokenHeader, sanitize, sendMessage, isServiceUrl));\n    }\n}\nexports.default = BeaconProxy;\nBeaconProxy.origSendBeacon = (_a = window === null || window === void 0 ? void 0 : window.navigator) === null || _a === void 0 ? void 0 : _a.sendBeacon;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}