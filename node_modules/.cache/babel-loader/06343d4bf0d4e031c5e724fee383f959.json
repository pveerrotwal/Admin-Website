{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst guards_js_1 = require(\"../app/guards.js\");\nconst messages_gen_js_1 = require(\"../app/messages.gen.js\");\nfunction default_1(app) {\n  if (!window.FontFace) {\n    return;\n  }\n  const docFonts = new Map();\n  const patchWindow = wnd => {\n    class FontFaceInterceptor extends wnd.FontFace {\n      constructor(...args) {\n        //maybe do this on load(). In this case check if the document.fonts.load(...) function calls the font's load()\n        if (typeof args[1] === 'string') {\n          let desc = '';\n          if (args[2]) {\n            app.safe(() => {\n              desc = JSON.stringify(args[2]);\n            });\n          }\n          const ffData = [args[0], args[1], desc];\n          const ffDataArr = docFonts.get(wnd.document) || [];\n          ffDataArr.push(ffData);\n          docFonts.set(wnd.document, ffDataArr);\n          const parentID = wnd === window ? 0 : app.nodes.getID(wnd.document);\n          if (parentID === undefined) {\n            return;\n          }\n          if (app.active()) {\n            app.send((0, messages_gen_js_1.LoadFontFace)(parentID, ...ffData));\n          }\n        }\n        super(...args);\n      }\n    }\n    wnd.FontFace = FontFaceInterceptor;\n  };\n  app.observer.attachContextCallback(patchWindow);\n  patchWindow(window);\n  app.nodes.attachNodeCallback(app.safe(node => {\n    if (!(0, guards_js_1.isDocument)(node)) {\n      return;\n    }\n    const ffDataArr = docFonts.get(node);\n    if (!ffDataArr) {\n      return;\n    }\n    const parentID = node.defaultView === window ? 0 : app.nodes.getID(node);\n    if (parentID === undefined) {\n      return;\n    }\n    ffDataArr.forEach(ffData => {\n      app.send((0, messages_gen_js_1.LoadFontFace)(parentID, ...ffData));\n    });\n  }));\n}\nexports.default = default_1;","map":{"version":3,"names":["Object","defineProperty","exports","value","guards_js_1","require","messages_gen_js_1","default_1","app","window","FontFace","docFonts","Map","patchWindow","wnd","FontFaceInterceptor","constructor","args","desc","safe","JSON","stringify","ffData","ffDataArr","get","document","push","set","parentID","nodes","getID","undefined","active","send","LoadFontFace","observer","attachContextCallback","attachNodeCallback","node","isDocument","defaultView","forEach","default"],"sources":["/Users/paramvirrotwal/Observability/website-admin-react-web-app-project/node_modules/@openreplay/tracker/cjs/modules/fonts.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst guards_js_1 = require(\"../app/guards.js\");\nconst messages_gen_js_1 = require(\"../app/messages.gen.js\");\nfunction default_1(app) {\n    if (!window.FontFace) {\n        return;\n    }\n    const docFonts = new Map();\n    const patchWindow = (wnd) => {\n        class FontFaceInterceptor extends wnd.FontFace {\n            constructor(...args) {\n                //maybe do this on load(). In this case check if the document.fonts.load(...) function calls the font's load()\n                if (typeof args[1] === 'string') {\n                    let desc = '';\n                    if (args[2]) {\n                        app.safe(() => {\n                            desc = JSON.stringify(args[2]);\n                        });\n                    }\n                    const ffData = [args[0], args[1], desc];\n                    const ffDataArr = docFonts.get(wnd.document) || [];\n                    ffDataArr.push(ffData);\n                    docFonts.set(wnd.document, ffDataArr);\n                    const parentID = wnd === window ? 0 : app.nodes.getID(wnd.document);\n                    if (parentID === undefined) {\n                        return;\n                    }\n                    if (app.active()) {\n                        app.send((0, messages_gen_js_1.LoadFontFace)(parentID, ...ffData));\n                    }\n                }\n                super(...args);\n            }\n        }\n        wnd.FontFace = FontFaceInterceptor;\n    };\n    app.observer.attachContextCallback(patchWindow);\n    patchWindow(window);\n    app.nodes.attachNodeCallback(app.safe((node) => {\n        if (!(0, guards_js_1.isDocument)(node)) {\n            return;\n        }\n        const ffDataArr = docFonts.get(node);\n        if (!ffDataArr) {\n            return;\n        }\n        const parentID = node.defaultView === window ? 0 : app.nodes.getID(node);\n        if (parentID === undefined) {\n            return;\n        }\n        ffDataArr.forEach((ffData) => {\n            app.send((0, messages_gen_js_1.LoadFontFace)(parentID, ...ffData));\n        });\n    }));\n}\nexports.default = default_1;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}