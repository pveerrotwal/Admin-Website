{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst messages_gen_js_1 = require(\"../app/messages.gen.js\");\nconst guards_js_1 = require(\"../app/guards.js\");\nfunction getDocumentScroll(doc) {\n  const win = doc.defaultView;\n  return [win && win.pageXOffset || doc.documentElement && doc.documentElement.scrollLeft || doc.body && doc.body.scrollLeft || 0, win && win.pageYOffset || doc.documentElement && doc.documentElement.scrollTop || doc.body && doc.body.scrollTop || 0];\n}\nfunction default_1(app) {\n  let documentScroll = false;\n  const nodeScroll = new Map();\n  function setNodeScroll(target) {\n    if (!(0, guards_js_1.isNode)(target)) {\n      return;\n    }\n    if ((0, guards_js_1.isElementNode)(target)) {\n      nodeScroll.set(target, [target.scrollLeft, target.scrollTop]);\n    }\n    if ((0, guards_js_1.isDocument)(target)) {\n      nodeScroll.set(target, getDocumentScroll(target));\n    }\n  }\n  const sendSetViewportScroll = app.safe(() => app.send((0, messages_gen_js_1.SetViewportScroll)(...getDocumentScroll(document))));\n  const sendSetNodeScroll = app.safe((s, node) => {\n    const id = app.nodes.getID(node);\n    if (id !== undefined) {\n      app.send((0, messages_gen_js_1.SetNodeScroll)(id, s[0], s[1]));\n    }\n  });\n  app.attachStartCallback(sendSetViewportScroll);\n  app.attachStopCallback(() => {\n    documentScroll = false;\n    nodeScroll.clear();\n  });\n  app.nodes.attachNodeCallback((node, isStart) => {\n    // MBTODO: iterate over all the nodes on start instead of using isStart hack\n    if (isStart) {\n      if ((0, guards_js_1.isElementNode)(node) && node.scrollLeft + node.scrollTop > 0) {\n        nodeScroll.set(node, [node.scrollLeft, node.scrollTop]);\n      } else if ((0, guards_js_1.isDocument)(node)) {\n        // DRY somehow?\n        nodeScroll.set(node, getDocumentScroll(node));\n      }\n    }\n    if ((0, guards_js_1.isRootNode)(node)) {\n      // scroll is not-composed event (https://javascript.info/shadow-dom-events)\n      app.nodes.attachNodeListener(node, 'scroll', e => {\n        setNodeScroll(e.target);\n      });\n    }\n  });\n  app.attachEventListener(document, 'scroll', e => {\n    const target = e.target;\n    if (target === document) {\n      documentScroll = true;\n      return;\n    }\n    setNodeScroll(target);\n  });\n  app.ticker.attach(() => {\n    if (documentScroll) {\n      sendSetViewportScroll();\n      documentScroll = false;\n    }\n    nodeScroll.forEach(sendSetNodeScroll);\n    nodeScroll.clear();\n  }, 5, false);\n}\nexports.default = default_1;","map":{"version":3,"names":["Object","defineProperty","exports","value","messages_gen_js_1","require","guards_js_1","getDocumentScroll","doc","win","defaultView","pageXOffset","documentElement","scrollLeft","body","pageYOffset","scrollTop","default_1","app","documentScroll","nodeScroll","Map","setNodeScroll","target","isNode","isElementNode","set","isDocument","sendSetViewportScroll","safe","send","SetViewportScroll","document","sendSetNodeScroll","s","node","id","nodes","getID","undefined","SetNodeScroll","attachStartCallback","attachStopCallback","clear","attachNodeCallback","isStart","isRootNode","attachNodeListener","e","attachEventListener","ticker","attach","forEach","default"],"sources":["/Users/paramvirrotwal/Observability/website-admin-react-web-app-project/node_modules/@openreplay/tracker/cjs/modules/scroll.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst messages_gen_js_1 = require(\"../app/messages.gen.js\");\nconst guards_js_1 = require(\"../app/guards.js\");\nfunction getDocumentScroll(doc) {\n    const win = doc.defaultView;\n    return [\n        (win && win.pageXOffset) ||\n            (doc.documentElement && doc.documentElement.scrollLeft) ||\n            (doc.body && doc.body.scrollLeft) ||\n            0,\n        (win && win.pageYOffset) ||\n            (doc.documentElement && doc.documentElement.scrollTop) ||\n            (doc.body && doc.body.scrollTop) ||\n            0,\n    ];\n}\nfunction default_1(app) {\n    let documentScroll = false;\n    const nodeScroll = new Map();\n    function setNodeScroll(target) {\n        if (!(0, guards_js_1.isNode)(target)) {\n            return;\n        }\n        if ((0, guards_js_1.isElementNode)(target)) {\n            nodeScroll.set(target, [target.scrollLeft, target.scrollTop]);\n        }\n        if ((0, guards_js_1.isDocument)(target)) {\n            nodeScroll.set(target, getDocumentScroll(target));\n        }\n    }\n    const sendSetViewportScroll = app.safe(() => app.send((0, messages_gen_js_1.SetViewportScroll)(...getDocumentScroll(document))));\n    const sendSetNodeScroll = app.safe((s, node) => {\n        const id = app.nodes.getID(node);\n        if (id !== undefined) {\n            app.send((0, messages_gen_js_1.SetNodeScroll)(id, s[0], s[1]));\n        }\n    });\n    app.attachStartCallback(sendSetViewportScroll);\n    app.attachStopCallback(() => {\n        documentScroll = false;\n        nodeScroll.clear();\n    });\n    app.nodes.attachNodeCallback((node, isStart) => {\n        // MBTODO: iterate over all the nodes on start instead of using isStart hack\n        if (isStart) {\n            if ((0, guards_js_1.isElementNode)(node) && node.scrollLeft + node.scrollTop > 0) {\n                nodeScroll.set(node, [node.scrollLeft, node.scrollTop]);\n            }\n            else if ((0, guards_js_1.isDocument)(node)) {\n                // DRY somehow?\n                nodeScroll.set(node, getDocumentScroll(node));\n            }\n        }\n        if ((0, guards_js_1.isRootNode)(node)) {\n            // scroll is not-composed event (https://javascript.info/shadow-dom-events)\n            app.nodes.attachNodeListener(node, 'scroll', (e) => {\n                setNodeScroll(e.target);\n            });\n        }\n    });\n    app.attachEventListener(document, 'scroll', (e) => {\n        const target = e.target;\n        if (target === document) {\n            documentScroll = true;\n            return;\n        }\n        setNodeScroll(target);\n    });\n    app.ticker.attach(() => {\n        if (documentScroll) {\n            sendSetViewportScroll();\n            documentScroll = false;\n        }\n        nodeScroll.forEach(sendSetNodeScroll);\n        nodeScroll.clear();\n    }, 5, false);\n}\nexports.default = default_1;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}